@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Dashboard";
}

<div class="dashboard-container">

    <h1 class="page-title">Estatísticas de Chamados</h1>

    <div class="grafico-card">
        <canvas id="graficoChamados" height="120"></canvas>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Converte dados vindos do controller
    var dados = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(ViewBag.DadosGrafico));

    var labels = dados.map(d => d.status);
    var valores = dados.map(d => d.quantidade);

    const ctx = document.getElementById("graficoChamados");

    new Chart(ctx, {
        type: "bar",
        data: {
            labels: labels,
            datasets: [{
                label: "Chamados por Status",
                data: valores,
                backgroundColor: "#B4FF00",
                borderColor: "#8FFF00",
                borderWidth: 3
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>

<style>
    .dashboard-container {
        max-width: 900px;
        margin: 30px auto;
        text-align: center;
    }

    .grafico-card {
        padding: 20px;
        background: white;
        border-radius: 14px;
        box-shadow: 0 4px 14px rgba(0,0,0,0.1);
        margin-top: 20px;
    }

    .page-title {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 20px;
        color: black;
    }
</style>
